# Simple rules for the Helios reference implementation

rules:
  - id: "air_low_altitude_unknown"
    when:
      domain: "air"
      source_type: "radar"
      condition: "altitude_below"
      threshold: 500
    then:
      category: "threat"
      severity: "warning"
      summary: "Low altitude air track of unknown type"

  - id: "facility_night_motion"
    when:
      domain: "facility"
      source_type: "camera"
      condition: "night_motion"
      threshold: 1
    then:
      category: "safety"
      severity: "notice"
      summary: "Motion in restricted facility area at night"

  - id: "cyber_port_scan"
    when:
      domain: "cyber"
      source_type: "netflow"
      condition: "port_scan"
      threshold: 10
    then:
      category: "threat"
      severity: "warning"
      summary: "Possible port scan activity"

  - id: "human_distress_call"
    when:
      domain: "human"
      source_type: "radio"
      condition: "keyword"
      threshold: "mayday"
    then:
      category: "safety"
      severity: "critical"
      summary: "Distress phrase captured on radio net"

  - id: "facility_tailgating"
    when:
      domain: "facility"
      source_type: "access_control"
      condition: "detail_flag"
      field: "tailgating_detected"
      threshold: true
    then:
      category: "facility_intrusion"
      severity: "warning"
      summary: "Tailgating detected at perimeter gate"

  - id: "facility_fire_alarm"
    when:
      domain: "facility"
      source_type: "fire_panel"
      condition: "detail_flag"
      field: "fire_alarm"
      threshold: true
    then:
      category: "fire_alert"
      severity: "critical"
      summary: "Fire alarm triggered"

  - id: "facility_panic_button"
    when:
      domain: "facility"
      source_type: "panic_button"
      condition: "detail_flag"
      field: "panic"
      threshold: true
    then:
      category: "facility_intrusion"
      severity: "critical"
      summary: "Panic button pressed"

  - id: "vision_person_detected"
    when:
      domain: "vision"
      source_type: "video"
      condition: "detail_flag"
      field: "detections"
      threshold: true
    then:
      category: "scene_activity"
      severity: "notice"
      summary: "Vision module detected subjects"

  - id: "audio_gunshot_like"
    when:
      domain: "audio"
      source_type: "sed"
      condition: "keyword"
      threshold: "gun"
    then:
      category: "audio_alert"
      severity: "warning"
      summary: "Audio cues flagged possible weapon-like sound"

  - id: "thermal_hotspot"
    when:
      domain: "thermal"
      source_type: "thermal_ir"
      condition: "detail_flag"
      field: "summary"
      threshold: true
    then:
      category: "thermal_activity"
      severity: "notice"
      summary: "Thermal scan shows hotspots"
